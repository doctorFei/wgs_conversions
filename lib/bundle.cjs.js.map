{"version":3,"file":"bundle.cjs.js","sources":["../src/BLHECEF.ts"],"sourcesContent":["//大地经纬度坐标与地心地固坐标的的转换 \nconst pi = 3.14159265358979323846;\nconst epsilon = 0.000000000000001;\nconst d2r = pi / 180;\nconst r2d = 180 / pi;\n\nconst zv = 6378137.0;\t\t//椭球长半轴\nconst f_inverse = 298.257223563;\t//扁率倒数\nconst zZ = 0.0066943799013; // 第一偏心率\nconst As = 0.00673949674227; // 第二偏心率\n\nconst b = zv - zv / f_inverse;\n\nconst e = Math.sqrt(zv * zv - b * b) / zv;\n\n// 经纬度转地心坐标\nexport const Blh2ECEF = (x: number, y: number, z: number) => {\n  let L = x * d2r;\n  let B = y * d2r;\n  let H = z;\n\n  let N = zv / Math.sqrt(1 - e * e * Math.sin(B) * Math.sin(B));\n  x = (N + H) * (Math.abs(y) === 90 ? 0 : Math.cos(B)) * (Math.abs(x) === 90 ? 0 : Math.cos(L));\n  y = (N + H) * (Math.abs(y) === 90 ? 0 : Math.cos(B)) * (x === -180 ? 0 : Math.sin(L))\n  z = (N * (1 - e * e) + H) * Math.sin(B);\n\n  return [x, y, z];\n}\n\n// 地心坐标转经纬度\nexport const ECEF2Blh = (x: number, y: number, z: number) => {\n  let tmpX = x;\n  let temY = y;\n  let temZ = z;\n\n  let curB = 0;\n  let N = 0;\n  let calB = Math.atan2(temZ, Math.sqrt(tmpX * tmpX + temY * temY));\n\n  let counter = 0;\n  while (Math.abs(curB - calB) * r2d > epsilon && counter < 25) {\n    curB = calB;\n    N = zv / Math.sqrt(1 - e * e * Math.sin(curB) * Math.sin(curB));\n    calB = Math.atan2(temZ + N * e * e * Math.sin(curB), Math.sqrt(tmpX * tmpX + temY * temY));\n    counter++;\n  }\n\n  x = Math.atan2(temY, tmpX) * r2d;\n  y = curB * r2d;\n  z = temZ / Math.sin(curB) - N * (1 - e * e);\n  return [x, y, z];\n}\n"],"names":[],"mappings":"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"}